# PhotoToKML

## Overview
`PhotoToKML` is a Python script that extracts GPS information and timestamps (photo capture time) from photos and generates KML files. These KML files can be visualized in tools like Google Earth to view the exact locations where the photos were taken.

The script supports recursive directory traversal, clustering GPS points by proximity, and adding photo capture times as timestamps in the KML files.

## Features
- Extract GPS coordinates and timestamps from photo EXIF metadata.
- Generate KML files for visualizing locations in mapping tools.
- Cluster points so that the distance between any two points in the same group does not exceed 1.8 km.
- Add capture time for each point in the KML file.
- Automatically skip directories without photo files.
- Maintain structured output with separate folders for each processed directory.
- Consolidate all generated files into a central folder for easy access.

## Usage
1. Ensure the required Python libraries are installed:
   ```bash
   pip install exif pykml lxml tqdm numpy scikit-learn
   ```

2. Run the script with the main directory as an argument:
   ```bash
   python PhotoToKML.py <path_to_main_directory>
   ```

   Replace `<path_to_main_directory>` with the path to the folder containing your photos.

3. After execution, check the following:
   - Each directory with photos will contain a new folder with generated KML and log files.
   - A consolidated folder (`Consolidated_Output`) will be created at the root for easy access to all outputs.

## Applications
- **Travel Visualization**: Use the script to map your travel photos and visualize your journey on Google Earth.
- **Photo Management**: Organize and analyze your photos based on geographical data.
- **Location-Based Analysis**: Useful for professionals like archaeologists, journalists, and environmentalists who need to track photo locations.

## Example KML Structure
A KML file generated by the script includes:
- **Placemark Name**: The photo's file name.
- **Coordinates**: GPS latitude and longitude of the photo location.
- **Timestamp**: The photo's capture time in ISO 8601 format.

```xml
<Placemark>
  <name>photo1.jpg</name>
  <TimeStamp>
    <when>2024-04-27T12:30:45Z</when>
  </TimeStamp>
  <Point>
    <coordinates>118.13,39.61194444444445</coordinates>
  </Point>
</Placemark>
```

## 中文版本

# PhotoToKML

## 概述
`PhotoToKML` 是一个 Python 脚本，用于从照片中提取 GPS 信息和时间戳（拍摄时间），并生成 KML 文件。这些 KML 文件可以在 Google Earth 等工具中可视化，展示照片拍摄的精确位置。

该脚本支持递归遍历目录、按距离聚类 GPS 点，并在 KML 文件中添加照片的拍摄时间戳。

## 功能特点
- 从照片的 EXIF 元数据中提取 GPS 坐标和时间戳。
- 生成 KML 文件，在地图工具中可视化位置。
- 对 GPS 点进行聚类，确保同组内任意两点的距离不超过 1.8 公里。
- 为每个点添加拍摄时间戳。
- 自动跳过没有照片文件的目录。
- 按目录结构输出，并为每个处理目录生成单独的文件夹。
- 在根目录下创建集中管理的文件夹，便于统一查看所有生成的文件。

## 使用方法
1. 确保已安装所需的 Python 库：
   ```bash
   pip install exif pykml lxml tqdm numpy scikit-learn
   ```

2. 使用主目录路径作为参数运行脚本：
   ```bash
   python PhotoToKML.py <主目录路径>
   ```

   将 `<主目录路径>` 替换为包含照片的文件夹路径。

3. 执行后，检查以下内容：
   - 每个包含照片的目录会有一个新的文件夹，内含生成的 KML 和日志文件。
   - 根目录下会生成一个集中管理文件夹 (`Consolidated_Output`)，便于统一查看所有输出文件。

## 应用场景
- **旅行可视化**：将旅行照片生成地图可视化，在 Google Earth 中查看旅行蹦迹。
- **照片管理**：基于地理数据组织和分析照片。
- **基于位置的分析**：适用于考古学家、记者、环保人士等需要跑踪照片拍摄位置的专业人士。

## KML 文件示例结构
脚本生成的 KML 文件包含以下内容：
- **Placemark 名称**：照片文件名。
- **坐标**：照片拍摄地点的 GPS 纬度和经度。
- **时间戳**：照片拍摄时间，格式为 ISO 8601。

脚本和readme文件由ChatGPT生成。
